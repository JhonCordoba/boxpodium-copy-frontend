name: GitHub Actions React + TypeScript + Vite
on:
  repository_dispatch:
    type: [pipeline-frontend]
  push:
    branches: [ "develop", "main" ]
jobs:
  actions: 
    runs-on: ubuntu-latest
    steps: 
      - uses: actions/checkout@v4

      - name: SetUp NodeJs
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: Install dependencies
        run: npm i

      - name: Build production bundle
        run: npm run build

      - name: Run pipeline Backend
        uses: octokit/request-action@v2.x
        with: 
          route: POST /repos/${{ github.event.repository.owner.login }}/${{ 'boxpodium-copy-backend' }}/dispatches
          token: ${{ secrets.GITHUB_TOKEN }}
          data:
            ref: ${{ github.ref }} 
            event_type: pipeline-backend
            client_payload: '{"frontend_commit": "${{ github.sha }}", "frontend_branch": "${{ github.ref }}"}'